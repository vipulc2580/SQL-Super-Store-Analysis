# SQL Super Store Analysis

![Sales Analysis ER Diagram](Sales%20Analysis%20ER%20Diagram%20SQL.png)

## Overview

This project entails the design and data analysis of a shoe retail chain using SQL. The primary objective is to extract meaningful insights from the sales data to inform business decisions and strategies.

## Dataset

The dataset comprises the following tables:

- **customer_details.csv**: Contains information about customers, including their IDs, names, and contact details.
- **products.csv**: Lists the products available in the store, along with their categories and prices.
- **sales_representative.csv**: Details about sales representatives, including their IDs and names.
- **salesdata.csv**: Records of sales transactions, including order IDs, dates, customer IDs, product IDs, quantities, and sales amounts.
- **suppliers.csv**: Information about product suppliers, including their IDs and names.

## Analysis Questions and Solutions

Below are the key questions addressed in this analysis, along with their corresponding SQL queries and insights:

1. **Total Sales and Average Sales**

   *Query:*
   ```sql
   SELECT 
       SUM(sales_amount) AS total_sales, 
       AVG(sales_amount) AS average_sales 
   FROM salesdata;
1. **What is the total sales amount generated by each sales representative?**
    *Query:*
   ```sql
		    select sales_representative.salesrepid as Sales_Representative_ID,
		    sales_representative.firstName as FirstName,
		    sales_representative.lastName as LastName,
		    t.total_Sales_Done
		    from sales_representative
		    right join 
		    (select sales.salesrepid,sum(totalamount) as total_Sales_Done from sales
		    group by sales.salesrepid
		   order by total_Sales_Done desc) as t
		   on sales_representative.salesrepid=t.salesrepid;

2. **How many products have been sold in each store location?**
			-- get supplier id for each product and then group by supplier id and count (product_id) sold indicating 
			--product sold by the supplier
     *Query:*
   ```sql
			 select products.supplierid as supplier,count(sales.productid) as Total_Product_Sold from sales
			 left join products
			 on sales.productid=products.productid
			 group by supplier;

3. **Which product category has the highest total sales amount?**
		--For each product find category from products table and group by cateogry and then aggregate as per total amount
		--order by total amount in descending order and limit it by one to get highest category sales
     *Query:*
   ```sql
		  select products.category as Category,sum(totalamount) as Total_Sales from sales
		  left join products
		  on sales.productid=products.productid
		  group by Category
		  order by Total_Sales desc
		  limit 1;
		
		
4. **What is the average quantity of products sold per sale?**
			-- group by product_id and then find average quantity sold for product and get name from products table
     *Query:*
   ```sql
			 select products.productname,ceil(avg(sales.quantity)) as Average_Units_Sold from sales
			 left join products
			 on sales.productid=products.productid
			 group by products.productname;
  
5. **Which customer has made the highest number of purchases?**
			--join on customer table get the name and sum totalamount by grouping on customer_id
     *Query:*
   ```sql
			select CustomerName,count(totalamount) as Number_Purchases
			from 
			(select sales.customerid,INITCAP(concat(customer.firstname,customer.lastname)) as CustomerName,sales.totalamount
			from sales
			left join customer
			on sales.customerid=customer.customerid)
		  group by CustomerName
			order by Number_Purchases desc
			limit 1;

6.**Customer with highest Revenue?**
		  *Query:*
   ```sql	
      select CustomerName,sum(totalamount) as Total_Revenue
			from 
			(select sales.customerid,INITCAP(concat(customer.firstname,customer.lastname)) as CustomerName,sales.totalamount
			from sales
			left join customer
			on sales.customerid=customer.customerid)
			group by CustomerName
			order by Total_Revenue desc
			limit 1;

7.**What is the distribution of total sales amounts across different days?**
```sql
		  select EXTRACT(DAY FROM saledate) AS DAY,sum(totalamount) as Total_Sales from sales
		  group by EXTRACT(DAY FROM saledate)
		  order by DAY;

8. **How does the sales performance of different state compare?**
--find sales based region and order them by sales amount
```sql
   select customer.state as State,sum(totalamount) as Total_Sales from sales
	  left join customer
		on customer.customerid=sales.customerid
		group by State
		order by Total_Sales desc;
			
-- 8. What is the total sales amount generated for each product?
		-- ger product name from products table
		-- select products.productname as Product_Name,sum(totalamount) as Total_Sales from sales
		-- left join products
		-- on products.productid=sales.productid
		-- group by Product_Name
		-- order by Total_Sales desc;
-- 9. What is the average sales amount per transaction?
			--average sales
			-- select ceil(avg(totalamount)) as Average_Sales from sales;
-- 10. How many sales transactions were made by each sales representative?
			-- select sales_representative.firstname as Name,count(sales.productid) as Sale_Count from sales
			-- left join sales_representative
			-- on sales_representative.salesrepid=sales.salesrepid
			-- group by Name
			-- order by Sale_Count desc;

-- ### Objective 2: Customer and Product Analysis

-- 1. What is the average spending per customer?

			-- select concat(customer.firstname,customer.lastname) as Name,ceil(avg(sales.totalamount)) as Average_Sales from sales
			-- left join customer
			-- on sales.customerid=customer.customerid
			-- group by Name 
			-- order by Average_Sales desc;
-- 2. Which product is the most frequently purchased by customers?
		-- getting product with highest count
		  -- select products.productName as Product_Name,count(*) as Product_Purchase_Count from sales
		  -- left join products
		  -- on sales.productid=products.productid
		  -- group by Product_Name
		  -- order by Product_Purchase_Count desc;
-- 3. How many unique customers made purchases in each city?
			 -- select customer.city as City,count(distinct sales.customerid) from sales
			 -- left join customer
			 -- on customer.customerid=sales.customerid
			 -- group by City;
-- 4. What is the distribution of product categories purchased by customers?
			-- with category_count(category,total_count) as (select products.category as Category,sum(sales.quantity) as Quantity_Sold from sales
			-- left join products
			-- on products.productid=sales.productid
			-- group by Category)
			-- select category,(total_count::numeric/(select sum(quantity) from sales)::numeric)*100 as Percentage_Distribution from category_count;
			
-- 5. How many repeat customers are there in the dataset?
		-- select count(*) as Total_Repeated_Customer from (select customerid from sales
		-- group by customerid
		-- having count(*)>1);
-- 6. What is the average unit price of products purchased by customers? 
			-- select sum(totalamount)/sum(quantity) as Average_Unit_Price from Sales;
			--Product Wise average unit selling Price
			-- select products.productname as Product_Name,sum(totalamount)/sum(quantity) as Average_Product_Price from sales
			-- left join products
			-- on sales.productid=products.productid
			-- group by Product_Name;
-- 7. How does the spending behavior differ between customers from different states?
		-- For each product find out which state has highest sales
		--Find out sales as per state wise
			-- b.
					-- select customer.state as State,sum(totalamount) as Total_State_Revenue from sales
					-- left join customer
					-- on customer.customerid=sales.customerid
					-- group by State
					-- order by Total_State_Revenue desc;

					-- select Name,State,QuantitySold from (SELECT 
					-- 	p.productname AS Name,
					-- 	c.state AS State,
					-- 	COUNT(s.quantity) AS QuantitySold,
					-- 	DENSE_RANK() OVER (
					-- 		PARTITION BY p.productname 
					-- 		ORDER BY COUNT(s.quantity) DESC
					-- 	) AS StateRank
					-- FROM 
					-- 	sales s
					-- LEFT JOIN 
					-- 	products p ON p.productid = s.productid
					-- LEFT JOIN 
					-- 	customer c ON c.customerid = s.customerid
					-- GROUP BY 
					-- 	p.productname, c.state)
					-- 	where StateRank=1;

			
					
-- 8. Which supplier provides the most popular products?
			--find three popular products and their supplier
			-- select sales.productid,suppliers.suppliername from sales
			-- left join products
			-- on products.productid=sales.productid
			-- left join suppliers
			-- on suppliers.supplierid=products.supplierid
			-- group by sales.productid,suppliers.suppliername
			-- limit 3;
-- 9. What is the most common product category purchased by customers?
		-- select products.category as Category,count(totalamount) from sales
		-- left join products
		-- on products.productid=sales.productid
		-- group by Category
		-- limit 1;
-- 10. How many customers purchased more than one type of product?
			-- select count(*) as Count_Of_Customer from 
			-- (select sales.customerid,count(distinct productid) as DistinctProductPurchase from sales
			-- group by sales.customerid
			-- having count(distinct productid)>1);

-- ### Objective 3: Supplier and Product Performance

-- 1. What is the total sales amount for each supplier?
				-- select suppliers.suppliername As Supplier_Name,sum(totalamount) as TotalSales from sales
				-- left join products
				-- on products.productid=sales.productid
				-- left join suppliers
				-- on products.supplierid=suppliers.supplierid
				-- group by Supplier_Name;
-- 2. Which supplier has the highest average unit price for their products?
		 	-- 	select suppliers.suppliername As Supplier_Name,ceil(sum(totalamount)/sum(quantity)) as Average_Unit_Price from sales
				-- left join products
				-- on products.productid=sales.productid
				-- left join suppliers
				-- on products.supplierid=suppliers.supplierid
				-- group by Supplier_Name
				-- order by Average_Unit_Price desc
				-- limit 1;
-- 3. How many different products are provided by each supplier?
				-- select suppliers.suppliername as Supplier_Name,count(productid) as UniqueOfferings from products
				-- left join suppliers
				-- on products.supplierid=suppliers.supplierid
				-- group by Supplier_Name;
-- 4. What is the average total sales amount for products supplied by each supplier?
				-- select suppliers.suppliername as Name,ceil(avg(totalamount)) as Average_Sales from sales
				-- left join products
				-- on products.productid=sales.productid
				-- left join suppliers
				-- on suppliers.supplierid=products.supplierid
				-- group by Name;
				
-- 5. Which supplier's products have the highest total sales by quantity?
				-- select suppliers.suppliername as Name,sum(quantity) as Units_Sold from sales
				-- left join products
				-- on products.productid=sales.productid
				-- left join suppliers
				-- on suppliers.supplierid=products.supplierid
				-- group by Name
				-- order by Units_Sold desc
				-- limit 1;
-- 6. What is the most common category of products supplied by each supplier?
				-- select category as Category,count(suppliers.suppliername) as Count_Of_Supplier_Selling_Category_Product from products
				-- left join suppliers
				-- on products.supplierid=suppliers.supplierid
				-- group by 1;
				
-- 7. How does the performance of products from different suppliers compare?


				 
-- 8. What is the distribution of product categories provided by each supplier?
				-- with supplierCategoryDistribution(cateogry,supplier,productDistribution) as 
			 -- (select category as Category,suppliers.suppliername,round((count(productid)/sum(count(productid)) over(partition by suppliers.suppliername))*100,2)
			 --   as ProductDistribution from products
				-- left join suppliers
				-- on products.supplierid=suppliers.supplierid
				-- group by 1,2)
				-- select * from supplierCategoryDistribution;
				
-- 9. How many products from each supplier are in the top 10 best-selling products?
			--find top 10 products by units sold
				-- with topsellingProducts(productid,Total_Sales) as (select sales.productid,sum(quantity) as Total_Sales from sales
				-- group by sales.productid
				-- order by Total_Sales desc),
				-- productListWithSupplier(supplierName,productName,productid) as(
				-- 	select suppliers.suppliername as SupplierName,productname as ProductName,productid from products
				-- 	left join suppliers
				-- 	on suppliers.supplierid=products.supplierid
				-- 	group by SupplierName,ProductName,productid
				-- )
				-- select  supplierName,productName from productListWithSupplier
				-- where productid in (select productid from topsellingProducts);
				-- select * from topsellingProducts;
				
-- 10. What is the average sales amount per product category for each supplier?
			-- select suppliers.suppliername as Name,products.category as Category,ceil(avg(totalamount)) as Average_Sales_Amount
			-- from sales
			-- left join products
			-- on sales.productid=products.productid
			-- left join suppliers
			-- on products.supplierid=suppliers.supplierid
			-- group by Name,Category;
   
